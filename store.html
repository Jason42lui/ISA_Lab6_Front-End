<!DOCTYPE html>
<html>

<head>
    <title>Dictionary Store</title>
</head>

<body>
    <h1>Dictionary Store</h1>

    <label for="word">Word:</label>
    <input type="text" id="word" placeholder="Enter the word"><br><br>

    <label for="definition">Definition:</label>
    <textarea id="definition" placeholder="Enter the definition"></textarea><br><br>

    <button onclick="submitDefinition()">Submit</button>

    <!-- Display feedback here -->
    <div id="feedback"></div>
    <div class="home-button-container" id="home-button-container">
        <button onclick="goHome()">Home</button>
    </div>
</body>
<script>

    const message = "Please enter valid word and definition (alphabet letters only)!"
    const indexHTMLString = "index.html";
    const CONTENT_TYPE_STRING = "Content-Type";
    const APPLICATION_JSON_STRING = "application/json";
    const POST_STRING = "POST";
    const FEED_BACK_STRING = "feedback";
    const WORD_STRING = "word";
    const DEFINITION_STRING = "definition"

    function goHome() {
        window.location.href = indexHTMLString;
    }

    function submitDefinition() {
        // Set the endpointAPI root
        const endPointRoot = "https://comp-4537-lab4-backend.onrender.com/api/";
        // Get the input values
        const word = document.getElementById(WORD_STRING).value;
        const definition = document.getElementById(DEFINITION_STRING).value;

        // Regular expression pattern for alphabet letters only
        const lettersOnlyRegex = /^[A-Za-z]+$/;

        // Regular expression pattern for alphabet letters and spaces only
        const lettersWithSpacesAndPunctuationsRegex = /^[A-Za-z\s.,!?'"()]+$/;

        // Check if word and definition are not empty and perform basic input validation
        if (word && definition && lettersOnlyRegex.test(word) && lettersWithSpacesAndPunctuationsRegex.test(definition)) {
            // Create params object
            const params = {
                word: word,
                definition: definition
            };

            // Make xhttp request here
            const xhttp = new XMLHttpRequest();
            xhttp.open(POST_STRING, endPointRoot, true);
            xhttp.setRequestHeader(CONTENT_TYPE_STRING, APPLICATION_JSON_STRING);
            xhttp.send(JSON.stringify(params));
            xhttp.onreadystatechange = () => {
                if (xhttp.readyState == 4 && xhttp.status == 200) {
                    let responseData = JSON.parse(xhttp.responseText);
                    let responseText = responseData.responseText;
                    document.getElementById(FEED_BACK_STRING).innerHTML = responseText;
                }

            };
        } else {
            // Display error message if either word or definition is empty or contains non-alphabet characters
            document.getElementById(FEED_BACK_STRING).innerHTML = message;
        }
    }
</script>

</html>